<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Your Quote | Northwest Airport Transfers</title>

  <!-- Fonts + Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: { colors:{ primary:'#0A2239', accent:'#005bb5' }, boxShadow:{ card:'0 12px 32px rgba(0,0,0,.08)' } }
      }
    }
  </script>
  <style>
    body{font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .btn{ @apply inline-flex items-center justify-center font-semibold rounded-xl px-4 py-3 transition; }
    .btn-accent{ @apply bg-accent text-white hover:bg-blue-700; }
    .btn-dark{ @apply bg-gray-900 text-white hover:bg-black; }
    .btn-success{ background:#0C6B61; color:#fff; }
    .btn-success:hover{ background:#0A5A51; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <header class="bg-primary text-white">
    <div class="max-w-6xl mx-auto px-4 py-5 flex items-center justify-between">
      <h1 class="text-lg md:text-xl font-bold">Northwest Airport Transfers</h1>
      <a href="index.html" class="btn btn-accent">‚Üê Back to Booking</a>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-10">
    <h2 class="text-3xl font-bold text-primary text-center">Your Booking Summary</h2>

    <div id="contentWrap" class="mt-8 grid md:grid-cols-5 gap-6">
      <!-- Summary -->
      <div class="md:col-span-3 bg-white rounded-2xl shadow-card border border-gray-100">
        <table class="w-full text-sm md:text-base">
          <tbody id="summaryTable"><!-- filled by JS --></tbody>
        </table>
      </div>

      <!-- Price box (pricing only here) -->
      <aside class="md:col-span-2 bg-white rounded-2xl shadow-card border border-gray-100 p-6">
        <p class="text-gray-500">Estimated Price</p>
        <div id="quotePrice" class="text-4xl font-extrabold text-primary mt-1">¬£0</div>
        <p class="text-sm text-gray-500 mt-1">For other journeys, please call us for a custom quote.</p>

        <div class="mt-6 grid gap-2">
          <button id="confirmWhatsApp" class="btn btn-success">üí¨ Confirm via WhatsApp</button>
          <button id="confirmEmail" class="btn btn-accent">‚úâÔ∏è Confirm via Email</button>
          <a href="index.html" class="btn btn-dark mt-1">‚Üê Amend Booking</a>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-primary text-white mt-12">
    <div class="max-w-6xl mx-auto px-4 py-8 text-center">
      <p>&copy; 2025 Northwest Airport Transfers ‚Ä¢ All Rights Reserved</p>
    </div>
  </footer>

  <script>
    const WHATSAPP_NUMBER = "447123456789"; // replace
    const EMAIL_ADDRESS  = "bookings@northwestairporttransfers.com";

    function loadBooking(){
      const data = JSON.parse(localStorage.getItem("bookingData") || "{}");
      if(!data.pickup){
        document.getElementById('contentWrap').innerHTML =
          '<div class="md:col-span-5 bg-white rounded-2xl shadow-card border border-gray-100 p-6 text-center">'+
          '<h3 class="text-xl font-bold text-primary">No booking found</h3>'+
          '<p class="mt-2 text-gray-600">Please return to the booking page and fill in your details.</p>'+
          '<a class="btn btn-accent mt-4" href="index.html">Go to Booking</a></div>';
        return null;
      }
      return data;
    }

    function row(label, value){
      return `<tr class="border-b border-gray-100"><th class="text-left font-semibold text-gray-700 p-3 w-48">${label}</th><td class="p-3">${value || '‚Äî'}</td></tr>`;
    }

    function renderSummary(d){
      const dropoff = d.journeyType === "return" ? d.dropoffAirport : d.dropoffAddress;
      const tbody = [
        row("Passenger", d.passengerName),
        row("Mobile", d.mobile),
        d.email ? row("Email", d.email) : "",
        row("Journey Type", d.journeyType),
        row("Pickup", d.pickup),
        row("Dropoff", dropoff),
        row("Pickup Date/Time", `${d.pickupDate} at ${d.pickupTime}`),
        d.journeyType === "return" ? row("Return Date/Time", `${d.returnDate} at ${d.returnTime}`) : "",
        d.flightOutbound ? row("Outbound Flight", d.flightOutbound) : "",
        d.flightInbound ? row("Inbound Flight", d.flightInbound) : "",
        row("Passengers", d.passengers),
        row("Number of Suitcases", d.luggage || '‚Äî'),
        row("Payment", d.payment),
        d.notes ? row("Notes", d.notes) : "",
      ].filter(Boolean).join("");
      document.getElementById("summaryTable").innerHTML = tbody;
    }

    // Pricing rules (only here)
    function calculatePrice(d){
      const pax = d.passengers === "4+" ? 4 : parseInt(d.passengers || "1", 10);
      const isLarge = pax >= 4;

      const pickup = (d.pickup || "").toLowerCase();
      const drop = ((d.journeyType === "return" ? d.dropoffAirport : d.dropoffAddress) || "").toLowerCase();

      let priceOneWay = null;

      const fromBolton = pickup.includes("bolton");
      const fromWigan  = pickup.includes("wigan");
      const toManchester = drop.includes("manchester");
      const toLiverpool  = drop.includes("liverpool");

      if (fromBolton && toManchester)       priceOneWay = isLarge ? 65 : 50;
      else if (fromWigan && toManchester)   priceOneWay = isLarge ? 70 : 55;
      else if (fromBolton && toLiverpool)   priceOneWay = isLarge ? 80 : 70;
      else if (fromWigan && toLiverpool)    priceOneWay = isLarge ? 80 : 70;

      if(priceOneWay === null) return { text:"Please call us for a custom quote.", numeric:null };

      const total = d.journeyType === "return" ? priceOneWay * 2 : priceOneWay;
      return { text:`¬£${total}`, numeric:total };
    }

    function buildMessage(d, priceText){
      return [
        "üöñ Airport Transfer Booking Request",
        "",
        `üë§ Passenger: ${d.passengerName}`,
        `üì± Mobile: ${d.mobile}`,
        d.email ? `üìß Email: ${d.email}` : "",
        "",
        `üö¶ Journey Type: ${d.journeyType}`,
        `üìç Pickup: ${d.pickup}`,
        `üèÅ Dropoff: ${d.journeyType === "return" ? d.dropoffAirport : d.dropoffAddress}`,
        `üìÖ Pickup: ${d.pickupDate} at ${d.pickupTime}`,
        d.journeyType === "return" ? `üìÖ Return: ${d.returnDate} at ${d.returnTime}` : "",
        d.flightOutbound ? `üõ´ Outbound Flight: ${d.flightOutbound}` : "",
        d.flightInbound ? `üõ¨ Inbound Flight: ${d.flightInbound}` : "",
        `üë• Passengers: ${d.passengers}`,
        `üß≥ Number of suitcases: ${d.luggage || '‚Äî'}`,
        `üí≥ Payment: ${d.payment}`,
        d.notes ? `üìù Notes: ${d.notes}` : "",
        "",
        `üí∑ Estimated Price: ${priceText}`
      ].filter(Boolean).join("\n");
    }

    const booking = loadBooking();
    if(booking){
      renderSummary(booking);
      const price = calculatePrice(booking);
      document.getElementById("quotePrice").textContent = price.text;

      document.getElementById("confirmWhatsApp").onclick = () => {
        const msg = buildMessage(booking, price.text);
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`,"_blank","noopener");
      };
      document.getElementById("confirmEmail").onclick = () => {
        const subject = "Airport Transfer Booking Request";
        const body = buildMessage(booking, price.text);
        window.location.href = `mailto:${EMAIL_ADDRESS}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      };
    }
  </script>
</body>
</html>
